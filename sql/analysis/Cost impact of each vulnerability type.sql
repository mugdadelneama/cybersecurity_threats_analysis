
-- Cost impact of each vulnerability type

-- QUERY 1: TOTAL COST IMPACT BY VULNERABILITY TYPE (MAIN ANSWER)
-- Shows how much money each security problem costs across all industries
SELECT 
    ROW_NUMBER() OVER (ORDER BY SUM(financial_loss_million) DESC) as "Cost Rank",
    security_vulnerability_type as "Security Problem",
    CONCAT('$', ROUND(SUM(financial_loss_million), 1), ' Million') as "Total Money Lost",
    COUNT(*) as "Number of Incidents",
    CONCAT('$', ROUND(AVG(financial_loss_million), 1), ' Million') as "Average Cost Per Incident",
    CASE 
        WHEN SUM(financial_loss_million) > 500 THEN 'EXTREMELY EXPENSIVE'
        WHEN SUM(financial_loss_million) > 300 THEN 'VERY EXPENSIVE'
        WHEN SUM(financial_loss_million) > 200 THEN 'EXPENSIVE'
        ELSE 'MODERATE COST'
    END as "Cost Impact Level"
FROM global_cybersecurity_threats 
GROUP BY security_vulnerability_type
ORDER BY SUM(financial_loss_million) DESC;

-- QUERY 2: COST BREAKDOWN WITH CUSTOMER IMPACT (ALL INDUSTRIES)
-- Shows both financial and customer costs across all sectors
SELECT 
    security_vulnerability_type as "Security Problem",
    CONCAT('$', ROUND(SUM(financial_loss_million), 1), ' Million') as "Total Financial Loss",
    FORMAT(SUM(number_of_affected_users), 0) as "Total Customers Affected",
    CONCAT('$', ROUND(SUM(financial_loss_million) / SUM(number_of_affected_users) * 1000000, 0)) as "Cost Per Customer Affected",
    COUNT(DISTINCT target_industry) as "Industries Affected",
    ROUND(AVG(incident_resolution_hours), 0) as "Average Hours to Fix",
    GROUP_CONCAT(DISTINCT target_industry ORDER BY target_industry) as "Industries Hit by This Problem"
FROM global_cybersecurity_threats 
GROUP BY security_vulnerability_type
ORDER BY SUM(financial_loss_million) DESC;

-- QUERY 3: INDUSTRY-BY-INDUSTRY COST BREAKDOWN
-- Shows which industries lose the most money to each vulnerability type
SELECT 
    security_vulnerability_type as "Security Problem",
    target_industry as "Industry",
    COUNT(*) as "Incidents in This Industry",
    CONCAT('$', ROUND(SUM(financial_loss_million), 1), ' Million') as "Total Cost in This Industry",
    CONCAT('$', ROUND(AVG(financial_loss_million), 1), ' Million') as "Average Cost Per Incident",
    FORMAT(SUM(number_of_affected_users), 0) as "Customers Affected in This Industry"
FROM global_cybersecurity_threats 
GROUP BY security_vulnerability_type, target_industry
ORDER BY security_vulnerability_type, SUM(financial_loss_million) DESC;

-- QUERY 4: MOST EXPENSIVE SINGLE INCIDENTS BY VULNERABILITY TYPE
-- Shows the worst individual attacks for each vulnerability type (any industry)
SELECT 
    security_vulnerability_type as "Security Problem",
    CONCAT(country, ' ', target_industry, ' in ', year) as "Worst Incident Details",
    CONCAT('$', financial_loss_million, ' Million') as "Highest Single Loss",
    FORMAT(number_of_affected_users, 0) as "Customers Affected",
    attack_type as "Attack Method Used",
    CONCAT('Took ', incident_resolution_hours, ' hours to fix') as "Response Time",
    defense_mechanism_used as "Defense System Used"
FROM global_cybersecurity_threats 
WHERE financial_loss_million = (
    SELECT MAX(financial_loss_million) 
    FROM global_cybersecurity_threats t2 
    WHERE t2.security_vulnerability_type = global_cybersecurity_threats.security_vulnerability_type
)
ORDER BY financial_loss_million DESC;

-- QUERY 5: COST COMPARISON SUMMARY (ALL VULNERABILITIES)
-- Simple comparison of all vulnerability types
SELECT 
    security_vulnerability_type as "Security Problem",
    CONCAT('$', ROUND(SUM(financial_loss_million), 1), ' Million total cost') as "Total Financial Impact",
    CONCAT(COUNT(*), ' incidents across ', COUNT(DISTINCT target_industry), ' industries') as "Incident Spread",
    CONCAT(ROUND((COUNT(*) * 100.0 / (SELECT COUNT(*) FROM global_cybersecurity_threats)), 1), '% of all cyber attacks') as "Percentage of All Attacks",
    CASE 
        WHEN COUNT(*) = (SELECT MAX(cnt) FROM (SELECT COUNT(*) as cnt FROM global_cybersecurity_threats GROUP BY security_vulnerability_type) t) 
        THEN 'MOST COMMON THREAT'
        WHEN SUM(financial_loss_million) = (SELECT MAX(total_cost) FROM (SELECT SUM(financial_loss_million) as total_cost FROM global_cybersecurity_threats GROUP BY security_vulnerability_type) t)
        THEN 'MOST EXPENSIVE THREAT'
        ELSE 'SIGNIFICANT THREAT'
    END as "Threat Category"
FROM global_cybersecurity_threats 
GROUP BY security_vulnerability_type
ORDER BY SUM(financial_loss_million) DESC;

-- QUERY 6: COST PER INCIDENT ANALYSIS (ALL INDUSTRIES)
-- Which vulnerability types are most expensive per attack
SELECT 
    security_vulnerability_type as "Security Problem",
    COUNT(*) as "Total Incidents",
    CONCAT('$', ROUND(AVG(financial_loss_million), 1), ' Million') as "Average Cost Per Incident",
    CONCAT('$', MIN(financial_loss_million), 'M') as "Cheapest Incident",
    CONCAT('$', MAX(financial_loss_million), 'M') as "Most Expensive Incident",
    CONCAT('$', ROUND(MAX(financial_loss_million) - MIN(financial_loss_million), 1), 'M') as "Cost Range Difference",
    CASE 
        WHEN AVG(financial_loss_million) > 60 THEN 'HIGH COST PER INCIDENT'
        WHEN AVG(financial_loss_million) > 40 THEN 'MODERATE COST PER INCIDENT'
        ELSE 'LOW COST PER INCIDENT'
    END as "Cost Category"
FROM global_cybersecurity_threats 
GROUP BY security_vulnerability_type
ORDER BY AVG(financial_loss_million) DESC;

-- QUERY 7: GLOBAL COST IMPACT BY COUNTRY
-- Which countries face the highest costs for each vulnerability
SELECT 
    security_vulnerability_type as "Security Problem",
    country as "Country",
    COUNT(*) as "Incidents in This Country",
    CONCAT('$', ROUND(SUM(financial_loss_million), 1), ' Million') as "Total Cost in This Country",
    COUNT(DISTINCT target_industry) as "Industries Affected",
    GROUP_CONCAT(DISTINCT target_industry ORDER BY target_industry) as "Industries Hit"
FROM global_cybersecurity_threats 
GROUP BY security_vulnerability_type, country
ORDER BY security_vulnerability_type, SUM(financial_loss_million) DESC;

-- QUERY 8: EXECUTIVE SUMMARY - TOTAL COST IMPACT
-- One simple table showing everything management needs to know
SELECT 
    'GLOBAL CYBERSECURITY COST ANALYSIS' as "Report Type",
    CONCAT('$', ROUND(SUM(financial_loss_million), 1), ' Million') as "Total Global Losses",
    COUNT(*) as "Total Incidents Analyzed",
    CONCAT('$', ROUND(AVG(financial_loss_million), 1), ' Million') as "Average Loss Per Incident",
    COUNT(DISTINCT security_vulnerability_type) as "Different Vulnerability Types",
    COUNT(DISTINCT target_industry) as "Industries Affected",
    FORMAT(SUM(number_of_affected_users), 0) as "Total People Affected Worldwide"
FROM global_cybersecurity_threats;

-- QUERY 9: TOP 5 MOST EXPENSIVE VULNERABILITY TYPES
-- Quick ranking for busy executives
SELECT 
    ROW_NUMBER() OVER (ORDER BY SUM(financial_loss_million) DESC) as "Rank",
    security_vulnerability_type as "Vulnerability Type",
    CONCAT('$', ROUND(SUM(financial_loss_million), 1), 'M') as "Total Cost",
    COUNT(*) as "Incidents",
    CONCAT('$', ROUND(AVG(financial_loss_million), 1), 'M') as "Avg Per Incident"
FROM global_cybersecurity_threats 
GROUP BY security_vulnerability_type
ORDER BY SUM(financial_loss_million) DESC
LIMIT 5;